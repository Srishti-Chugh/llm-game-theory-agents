def exploitation_vulnerability(actions, beliefs, opponent_actions, threshold=0.7):
    """
    Measures how often agent cooperates when belief is high but opponent defects.
    For use with Bayesian belief-based games.
    """
    exploit_count = 0
    total = 0

    for a, b, opp in zip(actions, beliefs, opponent_actions):
        if b > threshold:
            total += 1
            if a == "C" and opp == "D":
                exploit_count += 1

    return exploit_count / total if total > 0 else 0


def combinatorial_exploitation_vulnerability(agent_actions, opponent_actions):
    """
    For combinatorial allocation games: measures the fraction of rounds where
    the agent's total allocation is strictly less than the opponent's
    (i.e., the agent is being 'out-allocated' / exploited).
    """
    exploit_count = 0
    for a, opp in zip(agent_actions, opponent_actions):
        if sum(a) < sum(opp):
            exploit_count += 1
    return exploit_count / len(agent_actions) if agent_actions else 0
