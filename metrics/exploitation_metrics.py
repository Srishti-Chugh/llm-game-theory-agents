def exploitation_vulnerability(actions, beliefs, opponent_actions, threshold=0.7):
    """
    Measures how often agent cooperates when belief is high but opponent defects
    """
    exploit_count = 0
    total = 0

    for a, b, opp in zip(actions, beliefs, opponent_actions):
        if b > threshold:
            total += 1
            if a == "C" and opp == "D":
                exploit_count += 1

    return exploit_count / total if total > 0 else 0